# CI Workflow

このディレクトリには、macOS環境セットアッププロセスの検証を自動化するためのCIワークフローの設定が含まれています。

## Overview

1. プルリクエスト時にコードレビューを実施
2. `install.sh`がmacOSで正しく動作することを検証
3. すべてのツールとアプリケーションが適切にインストールされ設定されていることを確認
4. インストールスクリプトの冪等性（副作用なく複数回実行可能）を検証

## Workflow Details

### Triggers

ワークフローは以下のタイミングで実行されます：
- `main`ブランチへのプッシュ
- `main`ブランチへのプルリクエスト
- ワークフローディスパッチによる手動実行

### Jobs

ワークフローは主に2つのジョブで構成されています：

#### 1. `code-review`

このジョブはプルリクエスト時のみ実行されます

#### 2. `test-install`

このジョブは実際のインストールと検証を実行します

- **リポジトリのチェックアウト**：リポジトリをクローン
- **GitHub認証のセットアップ**：CI環境用の認証を設定
- **スクリプト権限の付与**：適当なスクリプトに実行権限を付与
- **インストールスクリプトの実行**：初回インストールテスト、冪等性テスト、検証テストを実行

### Setup Test

1. **初回インストールテスト**
   - `install.sh`スクリプトを実行し、インストールの成功を確認

2. **冪等性テスト**
   - `install.sh`スクリプトを2回目に実行
   - コンポーネントが再インストールされないことを確認

3. **検証**
   - インストールされたすべてのコンポーネントを検証するために`verify_environment.sh`を実行

## Idempotency Testing

冪等性は、意図しない副作用やエラーを引き起こすことなく複数回実行できることを保証します。これにより、環境を壊す心配なく、更新や修復のためにインストールスクリプトを複数回安全に実行できます。

